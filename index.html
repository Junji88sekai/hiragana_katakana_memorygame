<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ひらがなカードゲーム</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 30px;
      background-image: url("images/background.png");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    .title-area {
      background-image: url("images/title-background.jpg");
      background-color: #fce4ec;
      background-size: cover;
      background-position: center;
      padding: 40px 0;
      margin-bottom: 20px;
    }

    .title-area img {
      max-width: 600px;
      width: 90%;
      height: auto;
    }

    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 20px;
    }

    label {
      margin: 10px;
      font-size: 18px;
    }

    .card-pair {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      margin: 30px 0;
    }

    .card-pair img {
      max-width: 250px;
      height: auto;
      border-radius: 10px;
      background-color: white;
      padding: 10px;
    }

    button {
      font-size: 20px;
      padding: 10px 20px;
      margin: 5px;
      border-radius: 8px;
      border: none;
      background-color: #f48fb1;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #ec407a;
    }
  </style>
</head>
<body>

  <!-- タイトル -->
  <div class="title-area">
    <img src="images/title.png" alt="タイトル画像">
  </div>

  <!-- チェックボックス -->
  <div class="checkbox-group">
    <label><input type="checkbox" value="a" onchange="updateCard()"> あ・か行</label>
    <label><input type="checkbox" value="sa" onchange="updateCard()"> さ・た行</label>
    <label><input type="checkbox" value="na" onchange="updateCard()"> な・は行</label>
    <label><input type="checkbox" value="ma" onchange="updateCard()"> ま・や行</label>
    <label><input type="checkbox" value="ma" onchange="updateCard()"> ら・わ行</label>
  </div>

  <!-- カード表示エリア -->
  <div class="card-pair" id="cardArea">
    <!-- 1枚の画像がここに入る -->
  </div>

  <!-- ボタン -->
  <button onclick="updateCard()">次のカードを表示する</button>
  <button id="retry" onclick="retry()" style="display:none;">もう一度</button>

  <script>
    const words = [
      "aka", "ao", "inu", "neko", "fune", "kuruma", "zou", "yama", "kasa", "sakana"
    ];

    const groups = {
      a: ["a", "i", "u", "e", "o", "k"],
      sa: ["s", "sh", "t", "ch", "ts"],
      na: ["n", "h", "f"],
      ma: ["m", "y", "r", "w"]
    };

    let shownWords = [];
    let shownCount = 0;
    let currentWord = "";
    let flipped = false;

    function updateCard() {
      const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
      const selectedGroups = Array.from(checkboxes).map(cb => cb.value);

      if (selectedGroups.length === 0) {
        document.getElementById("cardArea").innerHTML = "<p>チェックを入れてください</p>";
        document.getElementById("retry").style.display = "none";
        return;
      }

      const allowedChars = selectedGroups.flatMap(group => groups[group]);

      let filtered = words.filter(word =>
        allowedChars.some(char => word.startsWith(char))
      );

      filtered = filtered.filter(word => !shownWords.includes(word));

      if (filtered.length === 0) {
        document.getElementById("cardArea").innerHTML = "<p>すべてのカードを表示しました！</p>";
        document.getElementById("retry").style.display = "inline-block";
        return;
      }

      const randomWord = filtered[Math.floor(Math.random() * filtered.length)];
      shownWords.push(randomWord);
      shownCount++;
      currentWord = randomWord;
      flipped = false;

      const cardImage = `images/${currentWord}A.png`;

      document.getElementById("cardArea").innerHTML = `
        <img id="cardImage" src="${cardImage}" alt="カード">
        <img id="cardImage" src="images/kurumaA.png" alt="カード" onerror="this.style.border='3px solid red'; alert('画像が読み込めません: ' + this.src);">
      `;

      document.getElementById("retry").style.display = "none";
    }

    function retry() {
      shownWords = [];
      shownCount = 0;
      currentWord = "";
      flipped = false;
      updateCard();
    }

    // エンターキーで反転
    document.addEventListener("keydown", function(event) {
      if (event.key === "Enter" && currentWord && !flipped) {
        const image = document.getElementById("cardImage");
        image.src = `images/${currentWord}B.png`;
        flipped = true;
      }
    });
  </script>

</body>
</html>
